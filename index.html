<!DOCTYPE html>
<html class="dark" lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" name="viewport" />
  <title>OneSystem OS</title>
  <!-- PWA -->
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#0f172a">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="https://img.icons8.com/fluency/192/task.png">

  <link href="https://fonts.googleapis.com" rel="preconnect" />
  <link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&amp;display=swap"
    rel="stylesheet" />
  <link
    href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:wght,FILL@100..700,0..1&amp;display=swap"
    rel="stylesheet" />
  <script src="https://cdn.tailwindcss.com?plugins=forms,container-queries"></script>
  <style>
    /* Global Mobile Scale Boost */
    html {
      font-size: 18px;
      /* Default boosts everything (rem based) by 12.5% */
    }

    /* Custom Scrollbar */
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }

    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    /* Custom Range Slider Thumb */
    .custom-range::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 28px;
      height: 28px;
      background: #3b82f6;
      /* brand-500 */
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2);
    }

    .custom-range::-moz-range-thumb {
      width: 28px;
      height: 28px;
      background: #3b82f6;
      border-radius: 50%;
      cursor: pointer;
      box-shadow: 0 0 0 4px rgba(59, 130, 246, 0.2);
    }
  </style>
  <script id="tailwind-config">
    tailwind.config = {
      darkMode: "class",
      theme: {
        extend: {
          colors: {
            brand: { 500: "#3b82f6", 600: "#2563eb" },
            accent: { orange: "#f97316", red: "#ef4444", green: "#22c55e", purple: "#a855f7" },
            surface: { light: "#ffffff", dark: "#1e293b", darker: "#0f172a" },
            bg: { light: "#f1f5f9", dark: "#020617" }
          },
          fontFamily: { sans: ["Inter", "sans-serif"] },
          boxShadow: {
            'soft': '0 4px 20px -2px rgba(0, 0, 0, 0.05)',
            'card': '0 0 0 1px rgba(0,0,0,0.03), 0 1px 2px rgba(0,0,0,0.05)'
          }
        },
      },
    }
  </script>
  <style>
    .no-scrollbar::-webkit-scrollbar {
      display: none;
    }

    .no-scrollbar {
      -ms-overflow-style: none;
      scrollbar-width: none;
    }

    body {
      min-height: max(884px, 100dvh);
    }

    .mask-gradient {
      -webkit-mask-image: linear-gradient(to right, black 85%, transparent 100%);
    }

    /* Modal Styles */
    #add-modal {
      transition: opacity 0.2s;
    }

    #add-modal.open {
      pointer-events: auto;
      opacity: 1;
    }

    #add-modal.open>div {
      transform: scale(1);
    }

    opacity: 1;
    transform: translateY(0) scale(1);
    }
  </style>
</head>

<body
  class="bg-bg-light dark:bg-bg-dark text-slate-800 dark:text-slate-100 font-sans antialiased overflow-hidden h-screen flex">

  <!-- DESKTOP SIDEBAR -->
  <aside class="hidden lg:flex flex-col w-64 bg-slate-900 border-r border-slate-800 h-full p-6 z-50">
    <!-- Logo -->
    <div class="flex items-center gap-3 mb-10">
      <div
        class="size-8 rounded-lg bg-gradient-to-br from-brand-500 to-brand-600 flex items-center justify-center text-white shadow-lg shadow-brand-500/20">
        <span class="material-symbols-outlined text-[20px]">dns</span>
      </div>
      <h1 class="text-white font-bold text-lg tracking-tight">OneSystem</h1>
    </div>

    <!-- Nav -->
    <nav class="flex-1 space-y-2">
      <button onclick="window.switchView('dashboard')" id="side-nav-home"
        class="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-white bg-slate-800/50 border border-slate-700/50 transition-all group shadow-sm">
        <span class="material-symbols-outlined text-brand-500 fill-1">dashboard</span>
        <span class="text-sm font-semibold">Dashboard</span>
      </button>
      <button onclick="window.switchView('todo')" id="side-nav-todo"
        class="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-400 hover:bg-slate-800/50 hover:text-white transition-all group border border-transparent">
        <span class="material-symbols-outlined">check_circle</span>
        <span class="text-sm font-medium">To-Do List</span>
      </button>
      <button class="w-full flex items-center gap-3 px-4 py-3 rounded-xl text-slate-500 cursor-not-allowed opacity-50">
        <span class="material-symbols-outlined">group</span>
        <span class="text-sm font-medium">Team</span>
      </button>
    </nav>

    <!-- User -->
    <div class="mt-auto pt-6 border-t border-slate-800/50">
      <div class="flex items-center gap-3 bg-slate-800/30 p-3 rounded-xl border border-slate-800">
        <div
          class="w-8 h-8 rounded-full bg-slate-700 bg-[url('https://lh3.googleusercontent.com/aida-public/AB6AXuDhlPMKa8pjMO50PY0yQusUu2nFNSm8tm7R2gLjx1lTEH3CduMEj60SfGGexKF6H3aQ95xhTNLBaRRRsU9w6nhSiMIvekk3EPr-jCei')] bg-cover">
        </div>
        <div class="text-xs">
          <p class="text-white font-bold">Admin User</p>
          <p class="text-emerald-500 flex items-center gap-1"><span
              class="w-1.5 h-1.5 rounded-full bg-emerald-500"></span> Online</p>
        </div>
      </div>
    </div>
  </aside>

  <!-- CONTENT WRAPPER -->
  <div class="flex-1 h-full overflow-y-auto relative scroll-smooth w-full">

    <div id="view-dashboard" class="transition-opacity duration-300 pb-24 lg:pb-10">

      <header
        class="sticky top-0 z-40 bg-bg-light/80 dark:bg-bg-dark/80 backdrop-blur-lg border-b border-transparent dark:border-slate-800 transition-all duration-300">
        <div class="px-5 py-4 flex items-center justify-between">
          <div class="flex items-center gap-3">
            <div class="relative">
              <div
                class="w-10 h-10 rounded-full bg-slate-200 bg-cover bg-center ring-2 ring-white dark:ring-slate-700 shadow-sm"
                style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuDA50GyuBDyUHvsZ_zkpLRFtoor5KeIKfHM03v-Ac7BuJ0NZwdMvbyaT9yFPEiW6Iv7eJ3pIi48_H9GK4OSU1un1Ccqa_2VpALxmDprIkO_S-1ruhQoJmTULj17O8UtX4BM5Sm1RQX5T37QukAyhjlnx0BYVbIWmcJlTYQS_84b2SjakQrDVESO0N0usj8xTfoFNiYJK7c-yizXApJM5H34V55mtGYjse0uDb0UuNKNF8IuwT3DRgI-amK17AlGNADSf9ax1gzUdm1B");'>
              </div>
              <div
                class="absolute -bottom-0.5 -right-0.5 w-3.5 h-3.5 bg-green-500 rounded-full border-2 border-white dark:border-slate-800">
              </div>
            </div>
            <div class="flex flex-col">
              <span class="text-xs font-medium text-slate-500 dark:text-slate-400">OneSystem OS</span>
              <h1 class="text-lg font-bold leading-tight tracking-tight">Dashboard</h1>
            </div>
          </div>
          <div class="flex gap-2">
            <button onclick="window.resetApp()"
              class="w-10 h-10 rounded-full bg-white dark:bg-slate-800 shadow-card flex items-center justify-center text-slate-600 dark:text-slate-300 hover:text-red-500 transition-colors relative"
              title="Reset Data">
              <span class="material-symbols-outlined text-[20px]">restart_alt</span>
            </button>
          </div>
        </div>
      </header>
      <main class="flex flex-col w-full max-w-7xl mx-auto pb-6">
        <section class="mt-6 px-5">
          <div class="flex items-center justify-between mb-4">
            <h2 class="text-base font-bold uppercase tracking-wider text-slate-500 dark:text-slate-400">System
              Overview
            </h2>
            <button onclick="generateReport()" class="text-brand-500 text-sm font-bold hover:underline">Full
              Report</button>
          </div>
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 pb-2">
            <!-- Global Stat -->
            <div
              class="w-full p-6 rounded-2xl bg-surface-light dark:bg-surface-dark shadow-soft border border-slate-100 dark:border-slate-700/50 relative overflow-hidden flex flex-col justify-between h-40">
              <div class="flex justify-between items-start z-10">
                <span class="p-2 rounded-xl bg-blue-50 dark:bg-blue-900/20 text-blue-600 dark:text-blue-400">
                  <span class="material-symbols-outlined text-[24px]">dns</span>
                </span>
              </div>
              <div class="z-10">
                <div class="text-4xl font-bold text-slate-900 dark:text-white mb-1" id="global-stat">0%</div>
                <p class="text-sm font-medium text-slate-500 dark:text-slate-400">System Build</p>
              </div>
              <div
                class="absolute -right-6 -bottom-6 w-28 h-28 rounded-full border-[8px] border-blue-500/10 dark:border-blue-400/10">
              </div>
            </div>

            <!-- Critical Stat -->
            <div
              class="w-full p-6 rounded-2xl bg-surface-light dark:bg-surface-dark shadow-soft border border-slate-100 dark:border-slate-700/50 relative overflow-hidden flex flex-col justify-between h-40 group">
              <div class="flex justify-between items-start z-10">
                <span class="p-2 rounded-xl bg-red-50 dark:bg-red-900/20 text-red-600 dark:text-red-400">
                  <span class="material-symbols-outlined text-[24px]">warning</span>
                </span>
              </div>
              <div class="z-10">
                <div class="text-4xl font-bold text-slate-900 dark:text-white mb-1" id="p0-stat">0</div>
                <p class="text-sm font-medium text-red-500 dark:text-red-400">Critical Items</p>
              </div>
            </div>
          </div>
        </section>

        <!-- Filters Section -->
        <section class="mt-8">
          <div class="px-5 mb-5">
            <h2 class="text-2xl font-bold text-slate-900 dark:text-white">Task Management</h2>
            <p class="text-base text-slate-500 dark:text-slate-400 mt-1">Manage field operations and logistics.</p>
          </div>

          <div class="flex flex-col sm:flex-row gap-3 overflow-x-auto no-scrollbar pb-2 mb-6 px-5 md:px-0">
            <button onclick="toggleModal()"
              class="flex items-center justify-center gap-2 px-4 py-3 bg-brand-500 text-white rounded-xl shadow-lg shadow-brand-500/20 active:scale-95 transition-transform shrink-0 w-full sm:w-auto">
              <span class="material-symbols-outlined text-[24px]">add_circle</span>
              <span class="text-base font-semibold">New Task</span>
            </button>
            <button onclick="openIncident()"
              class="flex items-center justify-center gap-2 px-4 py-3 bg-white dark:bg-surface-dark border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 rounded-xl shadow-sm active:scale-95 transition-transform shrink-0 w-full sm:w-auto">
              <span class="material-symbols-outlined text-[24px] text-accent-red">emergency</span>
              <span class="text-base font-medium">Log Incident</span>
            </button>
            <button onclick="generateReport()"
              class="flex items-center justify-center gap-2 px-4 py-3 bg-white dark:bg-surface-dark border border-slate-200 dark:border-slate-700 text-slate-700 dark:text-slate-200 rounded-xl shadow-sm active:scale-95 transition-transform shrink-0 w-full sm:w-auto">
              <span class="material-symbols-outlined text-[24px] text-accent-purple">description</span>
              <span class="text-base font-medium">Report</span>
            </button>
          </div>

          <div
            class="sticky top-[73px] z-30 bg-bg-light/95 dark:bg-bg-dark/95 backdrop-blur-sm px-5 py-3 border-b border-slate-200 dark:border-slate-800/50 mb-6 transition-all">
            <div class="flex items-center justify-between gap-2">
              <div class="flex gap-2.5 overflow-x-auto no-scrollbar mask-gradient py-1">
                <button onclick="window.setFilter('all')"
                  class="px-4 py-2 rounded-full text-sm font-bold bg-slate-800 dark:bg-white text-white dark:text-slate-900 shadow-sm shrink-0">All</button>
                <button onclick="window.setFilter('high')"
                  class="px-4 py-2 rounded-full text-sm font-semibold bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 shrink-0">High
                  Priority</button>
                <button onclick="window.setFilter('crm')"
                  class="px-4 py-2 rounded-full text-sm font-semibold bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 shrink-0">CRM</button>
                <button onclick="window.setFilter('automation')"
                  class="px-4 py-2 rounded-full text-sm font-semibold bg-white dark:bg-slate-800 border border-slate-200 dark:border-slate-700 text-slate-600 dark:text-slate-300 shrink-0">Auto</button>
              </div>
              <div class="relative">
                <button onclick="document.getElementById('sort-menu').classList.toggle('hidden')"
                  class="p-2.5 -mr-2 rounded-full text-slate-400 hover:text-brand-500 hover:bg-slate-100 dark:hover:bg-slate-800 transition-colors">
                  <span class="material-symbols-outlined text-[28px]">sort</span>
                </button>

                <!-- Sort Menu -->
                <div id="sort-menu"
                  class="hidden absolute right-0 top-10 w-56 bg-white dark:bg-surface-dark rounded-xl shadow-xl border border-slate-100 dark:border-slate-700 py-2 z-50">
                  <div class="px-4 py-2 text-xs font-bold text-slate-400 uppercase tracking-wider">Sort By</div>
                  <button
                    onclick="window.setSort('p-high'); document.getElementById('sort-menu').classList.add('hidden')"
                    class="w-full text-left px-4 py-2.5 hover:bg-slate-50 dark:hover:bg-slate-800 flex items-center gap-2 text-sm text-slate-700 dark:text-slate-200">
                    <span class="material-symbols-outlined text-[18px] text-red-500">arrow_upward</span> Priority (High
                    â†’
                    Low)
                  </button>
                  <button
                    onclick="window.setSort('p-low'); document.getElementById('sort-menu').classList.add('hidden')"
                    class="w-full text-left px-4 py-2.5 hover:bg-slate-50 dark:hover:bg-slate-800 flex items-center gap-2 text-sm text-slate-700 dark:text-slate-200">
                    <span class="material-symbols-outlined text-[18px] text-green-500">arrow_downward</span> Priority
                    (Low
                    â†’
                    High)
                  </button>
                  <button
                    onclick="window.setSort('prog-high'); document.getElementById('sort-menu').classList.add('hidden')"
                    class="w-full text-left px-4 py-2.5 hover:bg-slate-50 dark:hover:bg-slate-800 flex items-center gap-2 text-sm text-slate-700 dark:text-slate-200">
                    <span class="material-symbols-outlined text-[18px] text-blue-500">percent</span> Progress (High â†’
                    Low)
                  </button>
                </div>
              </div>
            </div>
          </div>

          <div class="grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4 px-2 sm:px-5" id="task-list">
            <!-- Tasks will flow here -->
            <div class="text-center text-slate-500 py-10">Loading Tasks...</div>
          </div>
        </section>
      </main>

      <!-- ADD MODAL (Centered System Style) -->
      <div id="add-modal"
        class="fixed inset-0 z-[70] flex items-center justify-center p-4 bg-black/60 opacity-0 pointer-events-none transition-all duration-300 backdrop-blur-sm">
        <div
          class="bg-slate-900 w-full max-w-lg rounded-2xl p-6 shadow-2xl transform scale-95 transition-all duration-300 border border-slate-700 relative">
          <div class="flex justify-between items-center mb-6">
            <h3 class="text-xl font-bold text-white flex items-center gap-2">
              <span class="material-symbols-outlined text-brand-500">add_task</span> New Task
            </h3>
            <button onclick="toggleModal()"
              class="text-slate-400 hover:text-white p-2 rounded-full hover:bg-slate-800 transition-colors">
              <span class="material-symbols-outlined">close</span>
            </button>
          </div>

          <div class="flex flex-col gap-6">
            <!-- Task Title -->
            <div>
              <label class="block text-sm font-bold text-slate-400 uppercase tracking-wider mb-2">Task Title</label>
              <input type="text" id="task-input"
                class="w-full bg-slate-800 border border-slate-700 rounded-xl px-4 py-4 text-white placeholder-slate-500 focus:ring-2 focus:ring-brand-500 focus:border-brand-500 text-xl shadow-inner transition-all"
                placeholder="What needs to be done?">
            </div>

            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
              <!-- Priority -->
              <div>
                <label class="block text-sm font-bold text-slate-400 uppercase tracking-wider mb-2">Priority</label>
                <div class="relative">
                  <select id="new-task-priority"
                    class="w-full bg-slate-800 border border-slate-700 rounded-xl p-4 pl-10 text-white focus:ring-brand-500 cursor-pointer appearance-none text-base font-medium">
                    <option value="high">ðŸ”´ High (P0)</option>
                    <option value="medium">ðŸŸ  Medium (P1)</option>
                    <option value="low">ðŸŸ¢ Low (P2)</option>
                  </select>
                  <span
                    class="absolute left-3 top-3.5 material-symbols-outlined text-[20px] text-slate-400 pointer-events-none">flag</span>
                  <span
                    class="absolute right-3 top-3.5 material-symbols-outlined text-[20px] text-slate-400 pointer-events-none">expand_more</span>
                </div>
              </div>

              <!-- Category -->
              <div>
                <label class="block text-sm font-bold text-slate-400 uppercase tracking-wider mb-2">Category</label>
                <div class="relative">
                  <select id="new-task-category"
                    class="w-full bg-slate-800 border border-slate-700 rounded-xl p-4 pl-10 text-white focus:ring-brand-500 appearance-none cursor-pointer text-base font-medium">
                    <option value="General">General</option>
                    <option value="CRM">CRM</option>
                    <option value="Automation">Automation</option>
                    <option value="Logistics">Logistics</option>
                    <option value="Fieldwork">Fieldwork</option>
                    <option value="Finance">Finance</option>
                    <option value="IT">IT Support</option>
                    <option value="Incident">Incident</option>
                  </select>
                  <span
                    class="absolute left-3 top-1/2 -translate-y-1/2 material-symbols-outlined text-[20px] text-slate-400 pointer-events-none">folder</span>
                  <span
                    class="absolute right-3 top-1/2 -translate-y-1/2 material-symbols-outlined text-[20px] text-slate-400 pointer-events-none">expand_more</span>
                </div>
              </div>
            </div>

            <button onclick="window.addTask(); toggleModal();"
              class="w-full bg-brand-600 text-white font-bold py-4 rounded-xl mt-4 hover:bg-brand-500 hover:shadow-lg hover:shadow-brand-500/25 transition-all active:scale-95 text-xl flex items-center justify-center gap-2">
              <span class="material-symbols-outlined text-[28px]">add_circle</span>
              Create Task
            </button>
          </div>
        </div>
      </div>

      <!-- FLOATING BUTTON -->
      <button onclick="toggleModal()"
        class="fixed bottom-24 right-5 z-40 h-14 w-14 flex items-center justify-center rounded-full bg-slate-900 dark:bg-brand-600 text-white shadow-lg shadow-slate-900/30 dark:shadow-brand-600/40 hover:scale-105 active:scale-95 transition-all">
        <span class="material-symbols-outlined text-[28px]">add</span>
      </button>
    </div><!-- End Dashboard View -->

    <!-- VIEW: TO-DO -->
    <div id="view-todo" class="hidden w-full max-w-7xl mx-auto p-4 lg:p-8 transition-all duration-300">
      <!-- Header -->
      <div class="flex items-center gap-3 mb-6">
        <div class="bg-center bg-no-repeat bg-cover rounded-full size-10 border-2 border-brand-500"
          style='background-image: url("https://lh3.googleusercontent.com/aida-public/AB6AXuBR44R8ZaFk7l4gl8vNn4zdShSQYWDuqq1MMPlrnIYrCFVpZz7PA91t5IGGb4m75zrwxGUZCfyHVcStk0WxILcmuW1YR3AbKgakH1xQv1uvKtFnooyRxLl0ucinuIjDqOQfnQ3XEq2Ipq8xqGlBSZz7PA91t5IGGb4m75zrwxGUZCfyHVcStk0WxILcmuW1YR3AbKgakH1xQv1uvKtFnooyRxLl0ucinuIjDqOQfnQ3XEq2Ipq8xqGlBSZZPdQKk2xS_FExgvq0tSTMUErUXKvUhGC01etmZ4egvQQD-aF27panavk9W_sZtMBomT1NJboYLyIykndPjvg1NKiTI-kHPNumz7RN1goDNaNCC8NASw8PvO");'>
        </div>
        <div>
          <h2 class="text-lg font-bold dark:text-white">My Day</h2>
          <span class="text-xs text-slate-500" id="todo-date">Today</span>
        </div>
      </div>

      <div class="grid grid-cols-1 lg:grid-cols-12 gap-6">
        <!-- Sidebar / My Day Card -->
        <div class="lg:col-span-4">
          <div
            class="rounded-2xl shadow-lg bg-surface-light dark:bg-surface-dark overflow-hidden mb-6 relative group sticky top-24">
            <div class="h-32 bg-cover bg-center"
              style="background-image: url('https://lh3.googleusercontent.com/aida-public/AB6AXuDhlPMKa8pjMO50PY0yQusUu2nFNSm8tm7R2gLjx1lTEH3CduMEj60SfGGexKF6H3aQ95xhTNLBaRRRsU9w6nhSiMIvekk3EPr-jCeiCy6PFacnQ3XEq2Ipq8xqGlBSZZPdQKk2xS_FExgvq0tSTMUErUXKvUhGC01etmZ4egvQQD-aF27panavk9W_sZtMBomT1NJboYLyIykndPjvg1NKiTI-kHPNumz7RN1goDNaNCC8NASw8PvO');">
              <div class="absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"></div>
              <p class="absolute bottom-3 left-4 text-white text-xl font-bold">Focus</p>
            </div>
            <div class="p-6">
              <p class="text-slate-500 text-xs font-bold uppercase tracking-wider mb-1">Pending</p>
              <p class="text-3xl font-bold dark:text-white mb-4" id="todo-count">0</p>
              <div
                class="p-3 bg-blue-50 dark:bg-blue-900/20 rounded-lg text-xs leading-relaxed text-blue-800 dark:text-blue-200">
                "Small steps every day add up to big results. Keep moving!"
              </div>
            </div>
          </div>
        </div>

        <!-- Main List -->
        <div class="lg:col-span-8">
          <div
            class="mb-6 bg-white dark:bg-slate-800 p-6 rounded-xl shadow-sm border border-slate-100 dark:border-slate-700 flex flex-col gap-4">
            <input type="text" id="todo-input-text" placeholder="What needs to be done?"
              class="w-full bg-transparent border-0 border-b border-slate-200 dark:border-slate-600 focus:ring-0 text-xl font-medium py-3 px-0 text-slate-900 dark:text-white placeholder:text-slate-400">
            <div class="flex justify-between items-center">
              <input type="datetime-local" id="todo-input-date"
                class="bg-transparent text-sm font-bold text-slate-500 dark:text-slate-400 border-0 p-0 focus:ring-0">
              <button onclick="window.addToDoItem()"
                class="bg-brand-500 text-white px-6 py-3 rounded-xl hover:bg-brand-600 transition-colors font-bold text-lg flex items-center gap-2 shadow-lg shadow-brand-500/20 active:scale-95">
                <span class="material-symbols-outlined text-[24px]">add</span> Add
              </button>
            </div>
          </div>

          <div class="flex flex-col gap-3" id="todo-list-container">
            <!-- Injected JS -->
            <div class="text-center text-slate-500 py-10 text-sm">No tasks for today. Chill! ðŸŒ´</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Navigation (Mobile Only) -->
    <!-- Navigation (Mobile Only) -->
    <nav
      class="lg:hidden fixed bottom-0 w-full z-50 bg-surface-light/95 dark:bg-surface-dark/95 backdrop-blur-md border-t border-slate-200 dark:border-slate-800 pb-safe pt-3">
      <div class="max-w-7xl mx-auto px-6 pb-5 pt-1">
        <ul class="flex justify-around items-center">
          <li onclick="window.switchView('dashboard')"><a
              class="flex flex-col items-center gap-1.5 text-brand-600 dark:text-brand-500 cursor-pointer nav-item transition-transform active:scale-95"
              id="nav-home"><span class="material-symbols-outlined text-[28px] fill-1">dashboard</span><span
                class="text-xs font-bold tracking-wide">Home</span></a></li>
          <li onclick="window.switchView('todo')"><a
              class="flex flex-col items-center gap-1.5 text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300 cursor-pointer nav-item transition-transform active:scale-95"
              id="nav-todo"><span class="material-symbols-outlined text-[28px]">check_circle</span><span
                class="text-xs font-bold tracking-wide">To-Do</span></a></li>
          <li><a
              class="flex flex-col items-center gap-1.5 text-slate-400 dark:text-slate-500 hover:text-slate-600 dark:hover:text-slate-300 cursor-not-allowed opacity-50"><span
                class="material-symbols-outlined text-[28px]">settings</span><span
                class="text-xs font-bold tracking-wide">Settings</span></a></li>
        </ul>
      </div>
    </nav>

  </div> <!-- End Content Wrapper -->

  <!-- REPORT MODAL -->
  <div id="report-modal"
    class="fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/50 backdrop-blur-sm opacity-0 pointer-events-none transition-opacity duration-300">
    <div
      class="bg-surface-light dark:bg-surface-dark w-full max-w-md rounded-2xl p-6 shadow-2xl transform scale-95 transition-transform duration-300 border border-slate-700">
      <div class="flex justify-between items-center mb-4">
        <h3 class="text-xl font-bold dark:text-white">System Report</h3>
        <button onclick="closeReport()" class="text-slate-400 hover:text-white"><span
            class="material-symbols-outlined">close</span></button>
      </div>
      <div id="report-content"
        class="space-y-3 text-sm text-slate-600 dark:text-slate-300 mb-6 font-mono bg-slate-100 dark:bg-slate-800 p-4 rounded-lg">
        <!-- Content Injected via JS -->
      </div>
      <button onclick="window.copyReport()"
        class="w-full bg-brand-600 text-white font-bold py-3 rounded-xl hover:bg-brand-500 flex items-center justify-center gap-2">
        <span class="material-symbols-outlined">content_copy</span> Copy to Clipboard
      </button>
    </div>
  </div>

  <!-- PWA INSTALL PROMPT (Mobile) -->
  <div id="pwa-install-app"
    class="hidden fixed bottom-0 left-0 right-0 z-[60] p-4 pb-safe bg-white dark:bg-slate-800 border-t border-slate-200 dark:border-slate-700 shadow-[0_-4px_20px_rgba(0,0,0,0.2)] transform transition-transform duration-300 translate-y-full">
    <div class="max-w-md mx-auto flex items-center justify-between gap-4">
      <div class="flex items-center gap-3">
        <div
          class="size-10 rounded-xl bg-gradient-to-br from-brand-500 to-brand-600 flex items-center justify-center text-white shadow-lg shadow-brand-500/20">
          <span class="material-symbols-outlined text-[20px]">dns</span>
        </div>
        <div>
          <h3 class="font-bold text-slate-900 dark:text-white text-sm">Install OneSystem</h3>
          <p class="text-xs text-slate-500 dark:text-slate-400">Add to home screen for quick access</p>
        </div>
      </div>
      <div class="flex items-center gap-2">
        <button onclick="window.dismissInstall()"
          class="p-2 text-slate-400 hover:text-slate-600 dark:hover:text-slate-200 text-xs font-medium">Later</button>
        <button onclick="window.installPwa()"
          class="bg-brand-500 text-white px-4 py-2 rounded-lg text-xs font-bold shadow-md shadow-brand-500/20 active:scale-95 transition-all">Install</button>
      </div>
    </div>
  </div>

  <!-- IOS INSTALL INSTRUCTIONS MODAL -->
  <div id="ios-install-modal"
    class="hidden fixed inset-0 z-[60] bg-black/60 backdrop-blur-sm flex items-end sm:items-center justify-center p-4 transition-opacity duration-300">
    <div
      class="bg-white dark:bg-slate-800 w-full max-w-sm rounded-2xl p-6 shadow-2xl transform transition-all duration-300 translate-y-full sm:translate-y-0 relative">
      <button onclick="document.getElementById('ios-install-modal').classList.add('hidden')"
        class="absolute top-4 right-4 text-slate-400"><span class="material-symbols-outlined">close</span></button>
      <div class="flex justify-center mb-4">
        <span class="material-symbols-outlined text-4xl text-brand-500">ios_share</span>
      </div>
      <h3 class="text-lg font-bold text-center dark:text-white mb-2">Install on iOS</h3>
      <p class="text-sm text-center text-slate-500 dark:text-slate-400 mb-6">Install this app on your iPhone for the
        best experience.</p>

      <div class="flex flex-col gap-4 text-sm dark:text-slate-300">
        <div class="flex items-center gap-3">
          <span
            class="size-6 rounded-full bg-slate-100 dark:bg-slate-700 flex items-center justify-center font-bold text-xs">1</span>
          <span>Tap the <span class="font-bold">Share</span> button below</span>
        </div>
        <div class="flex items-center gap-3">
          <span
            class="size-6 rounded-full bg-slate-100 dark:bg-slate-700 flex items-center justify-center font-bold text-xs">2</span>
          <span>Select <span class="font-bold">Add to Home Screen</span></span>
        </div>
      </div>
      <div
        class="absolute -bottom-2 left-1/2 transform -translate-x-1/2 translate-y-full w-0 h-0 border-l-[10px] border-l-transparent border-r-[10px] border-r-transparent border-t-[10px] border-t-white dark:border-t-slate-800">
      </div>
    </div>
  </div>

  <script>
    function toggleModal(priority, category) {
      const modal = document.getElementById('add-modal');
      modal.classList.toggle('open');

      if (modal.classList.contains('open')) {
        document.getElementById('task-input').focus();

        // Pre-fill if args provided
        if (priority) document.getElementById('new-task-priority').value = priority;
        if (category) document.getElementById('new-task-category').value = category;
      } else {
        // Reset defaults on close
        setTimeout(() => {
          document.getElementById('new-task-priority').value = 'high';
          document.getElementById('new-task-category').value = '';
        }, 200);
      }
    }

    function openIncident() {
      toggleModal('high', 'Incident');
    }

    function generateReport() {
      const modal = document.getElementById('report-modal');
      const content = document.getElementById('report-content');

      // Calculate Stats
      const total = tasks.length;
      const completed = tasks.filter(t => t.progress === 100).length;
      const pending = total - completed;
      const high = tasks.filter(t => t.priority === 'high' && t.progress < 100).length;

      // Generate Text
      const text = `
<strong>OneSystem Status Report</strong><br>
------------------------<br>
Tasks Total: ${total}<br>
Completed: ${completed} (${Math.round((completed / total) * 100 || 0)}%)<br>
Pending: ${pending}<br>
Critical (P0): ${high}<br>
------------------------<br>
Generated: ${new Date().toLocaleTimeString()}
        `.trim();

      content.innerHTML = text;
      modal.classList.remove('opacity-0', 'pointer-events-none');
      modal.querySelector('div').classList.remove('scale-95');
      modal.querySelector('div').classList.add('scale-100');
    }

    function closeReport() {
      const modal = document.getElementById('report-modal');
      modal.classList.add('opacity-0', 'pointer-events-none');
      modal.querySelector('div').classList.add('scale-95');
      modal.querySelector('div').classList.remove('scale-100');
    }

    window.copyReport = function () {
      const text = document.getElementById('report-content').innerText;
      navigator.clipboard.writeText(text).then(() => alert('Report copied to clipboard!'));
    };
  </script>
  <script>
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./sw.js')
        .then(() => console.log('Service Worker Registered'))
        .catch(e => console.log('SW Registration Failed', e));
    }
  </script>
  <script src="app.js"></script>
</body>

</html>